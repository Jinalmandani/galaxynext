[
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item Group",
  "enabled": 1,
  "modified": "2025-08-13 17:40:19.431877",
  "module": "galaxynext",
  "name": "Item Group - Default Parameter Row",
  "script": "frappe.ui.form.on('Item Group', {\n  refresh(frm) {\n    // If empty, add initial row\n    if (!frm.doc.custom_parameters || frm.doc.custom_parameters.length === 0) {\n      let row = frm.add_child('custom_parameters');\n      row.parameter = 'Parameter 1';\n      row.status = 'Enable'; // or default you like\n      frm.refresh_field('custom_parameters');\n    }\n    // Always renumber\n    renumber(frm);\n  },\n  custom_parameters_add(frm, cdt, cdn) {\n    renumber(frm);\n  },\n  custom_parameters_remove(frm) {\n    renumber(frm);\n  }\n});\n\nfunction renumber(frm) {\n  frm.doc.custom_parameters.forEach((row, i) => {\n    row.idx = i + 1; \n  });\n  frm.refresh_field('custom_parameters');\n}\n\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-09-05 16:54:29.644342",
  "module": "galaxynext",
  "name": "12_08_item-parameter",
  "script": "// kp\n// function update_item_code_and_name(frm) {\n//     let parts = [];\n\n//     // Add item_name if no parameters\n//     if (frm.doc.item_name && !(frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0)) {\n//         parts.push(frm.doc.item_name.trim().toUpperCase());\n//     }\n\n//     // Add values from child table\n//     if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n//         let param_parts = frm.doc.custom_item_parameters\n//             .map(r => (r.value || '').trim())\n//             .filter(v => v !== '')\n//             .map(p => p.toUpperCase());\n//         parts = parts.concat(param_parts);\n//     }\n\n//     let final_code = parts.join('-');\n\n//     if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n//         // Parameters exist â†’ auto-generate & lock both fields\n//         frm.set_value('item_code', final_code);\n//         frm.set_value('item_name', final_code);\n\n//         frm.set_df_property('item_code', 'read_only', 1);\n//         frm.set_df_property('item_name', 'read_only', 1);\n//     } else {\n//         // No parameters â†’ allow manual entry\n//         frm.set_df_property('item_code', 'read_only', 0);\n\n//         // Auto-fill item_name = item_code, but allow editing later\n//         if (frm.doc.item_code && !frm.doc.item_name) {\n//             frm.set_value('item_name', frm.doc.item_code);\n//         }\n\n//         frm.set_df_property('item_name', 'read_only', 0);\n//     }\n// }\n\n// // Populate child table from Item Group\n// function populate_parameters(frm, params) {\n//     frm.clear_table('custom_item_parameters');\n//     params.forEach(function(p) {\n//         let status = (p.status || '').toString().toLowerCase();\n//         if (status && status !== 'enabled' && status !== 'enable') {\n//             return;\n//         }\n//         let row = frm.add_child('custom_item_parameters');\n//         row.parameter = p.parameter || p.name || '';\n//         row.value = ''; // user will fill later\n//     });\n//     frm.refresh_field('custom_item_parameters');\n//     update_item_code_and_name(frm);\n// }\n\n// frappe.ui.form.on('Item', {\n//     item_group: function(frm) {\n//         if (!frm.doc.item_group) {\n//             frm.clear_table('custom_item_parameters');\n//             frm.refresh_field('custom_item_parameters');\n//             update_item_code_and_name(frm);\n//             return;\n//         }\n\n//         frappe.call({\n//             method: \"frappe.client.get\",\n//             args: { doctype: \"Item Group\", name: frm.doc.item_group },\n//             callback: function(r) {\n//                 if (r.message) {\n//                     const params = r.message.parameters || r.message.custom_parameters || [];\n//                     populate_parameters(frm, params);\n//                 }\n//             }\n//         });\n//     },\n//     validate: function(frm) {\n//         update_item_code_and_name(frm);\n\n//         // ðŸ”´ Validation: all parameter values must be filled\n//         if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n//             let missing = frm.doc.custom_item_parameters.filter(r => !r.value || r.value.trim() === \"\");\n//             if (missing.length > 0) {\n//                 // Collect missing parameter names\n//                 let missing_params = missing.map(r => r.parameter).join(\", \");\n//                 frappe.throw((\"Please fill {0} parameter values before saving.\", [missing_params]));\n//             }\n//         }\n//     },\n//     item_code: function(frm) {\n//         // When no parameters â†’ auto-fill item_name = item_code\n//         if (!(frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0)) {\n//             if (frm.doc.item_code) {\n//                 frm.set_value('item_name', frm.doc.item_code);\n//             }\n//         }\n//     },\n//     item_name: function(frm) {\n//         update_item_code_and_name(frm);\n//     }\n// });\n\n// frappe.ui.form.on('Item Parameter', {\n//     value: function(frm) {\n//         update_item_code_and_name(frm);\n//     },\n//     custom_item_parameters_remove: function(frm) {\n//         update_item_code_and_name(frm);\n//     }\n// });\n\n// ---------------------------------------------------------------------------------\n\nfunction update_item_code_and_name(frm) {\n    let parts = [];\n\n    // âœ… Jo parameters na hoy â†’ item_name user enter kare to use\n    if (frm.doc.item_name && !(frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0)) {\n        parts.push(frm.doc.item_name.trim().toUpperCase());\n    }\n\n    // âœ… Jo parameters hoy â†’ child table ni values use karo\n    if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n        let param_parts = frm.doc.custom_item_parameters\n            .map(r => (r.value || '').trim())\n            .filter(v => v !== '')\n            .map(p => p.toUpperCase());\n        parts = parts.concat(param_parts);\n    }\n\n    let final_code = parts.join('-');\n    if (!final_code) return;\n\n    if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n        // ðŸ”’ Parameters hoy â†’ auto-generate & lock\n        frm.set_value('item_code', final_code);\n        frm.set_value('item_name', final_code);\n\n        // âœ… Auto-set Barcode child table\n        if (!frm.doc.barcodes || frm.doc.barcodes.length === 0) {\n            let row = frm.add_child('barcodes');\n            row.barcode = final_code;\n            row.barcode_type = \"CODE-39\";   // Default (only if new row)\n            row.uom = \"Nos\";                // Default (only if new row)\n        } else {\n            frm.doc.barcodes[0].barcode = final_code;\n\n            if (!frm.doc.barcodes[0].barcode_type) {\n                frm.doc.barcodes[0].barcode_type = \"CODE-39\";\n            }\n            if (!frm.doc.barcodes[0].uom) {\n                frm.doc.barcodes[0].uom = \"Nos\";\n            }\n        }\n        frm.refresh_field(\"barcodes\");\n\n        // ðŸ”’ Lock fields\n        frm.set_df_property('item_code', 'read_only', 1);\n        frm.set_df_property('item_name', 'read_only', 1);\n    } else {\n        // ðŸ”“ Parameters na hoy â†’ user enter kari shake\n        frm.set_df_property('item_code', 'read_only', 0);\n        frm.set_df_property('item_name', 'read_only', 0);\n\n        // Auto-fill item_name if blank\n        if (frm.doc.item_code && !frm.doc.item_name) {\n            frm.set_value('item_name', frm.doc.item_code);\n        }\n    }\n}\n\n// Populate parameters from Item Group\nfunction populate_parameters(frm, params) {\n    frm.clear_table('custom_item_parameters');\n    params.forEach(function(p) {\n        let status = (p.status || '').toString().toLowerCase();\n        if (status && status !== 'enabled' && status !== 'enable') {\n            return;\n        }\n        let row = frm.add_child('custom_item_parameters');\n        row.parameter = p.parameter || p.name || '';\n        row.value = ''; // user will fill later\n    });\n    frm.refresh_field('custom_item_parameters');\n    update_item_code_and_name(frm);\n}\n\nfrappe.ui.form.on('Item', {\n    item_group: function(frm) {\n        if (!frm.doc.item_group) {\n            frm.clear_table('custom_item_parameters');\n            frm.refresh_field('custom_item_parameters');\n            update_item_code_and_name(frm);\n            return;\n        }\n\n        frappe.call({\n            method: \"frappe.client.get\",\n            args: { doctype: \"Item Group\", name: frm.doc.item_group },\n            callback: function(r) {\n                if (r.message) {\n                    const params = r.message.parameters || r.message.custom_parameters || [];\n                    populate_parameters(frm, params);\n                }\n            }\n        });\n    },\n    validate: function(frm) {\n        update_item_code_and_name(frm);\n\n        // ðŸ”´ Validation: parameters filled check\n        if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n            let missing = frm.doc.custom_item_parameters.filter(r => !r.value || r.value.trim() === \"\");\n            if (missing.length > 0) {\n                let missing_params = missing.map(r => r.parameter).join(\", \");\n                frappe.throw(`Please fill ${missing_params} parameter values before saving.`);\n            }\n        }\n    },\n    item_code: function(frm) {\n        // Only when no parameters\n        if (!(frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0)) {\n            if (frm.doc.item_code) {\n                frm.set_value('item_name', frm.doc.item_code);\n            }\n        }\n    },\n    item_name: function(frm) {\n        update_item_code_and_name(frm);\n    }\n});\n\nfrappe.ui.form.on('Item Parameter', {\n    value: function(frm) {\n        update_item_code_and_name(frm);\n    },\n    custom_item_parameters_remove: function(frm) {\n        update_item_code_and_name(frm);\n    }\n});\n\n\n// ---------------------------------------------------------------\n\n// function update_item_code_and_name(frm) {\n//     let parts = [];\n\n//     // Add item_name if no parameters\n//     if (frm.doc.item_name && !(frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0)) {\n//         parts.push(frm.doc.item_name.trim().toUpperCase());\n//     }\n\n//     // Add values from child table\n//     if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n//         let param_parts = frm.doc.custom_item_parameters\n//             .map(r => (r.value || '').trim())\n//             .filter(v => v !== '')\n//             .map(p => p.toUpperCase());\n//         parts = parts.concat(param_parts);\n//     }\n\n//     let final_code = parts.join('-');\n//     if (!final_code) return;\n\n//     if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n//         // Parameters exist â†’ auto-generate & lock both fields\n//         frm.set_value('item_code', final_code);\n//         frm.set_value('item_name', final_code);\n\n//         frm.set_df_property('item_code', 'read_only', 1);\n//         frm.set_df_property('item_name', 'read_only', 1);\n//     } else {\n//         // No parameters â†’ allow manual entry\n//         frm.set_df_property('item_code', 'read_only', 0);\n\n//         // Auto-fill item_name = item_code, but allow editing later\n//         if (frm.doc.item_code && !frm.doc.item_name) {\n//             frm.set_value('item_name', frm.doc.item_code);\n//         }\n\n//         frm.set_df_property('item_name', 'read_only', 0);\n//     }\n\n//     // âœ… Auto-set Barcode child table\n//     if (!frm.doc.barcodes || frm.doc.barcodes.length === 0) {\n//         let row = frm.add_child('barcodes');\n//         row.barcode = final_code;\n//         row.barcode_type = \"CODE-39\";   // Default only for new row\n//         row.uom = \"Nos\";                // Default only for new row\n//     } else {\n//         frm.doc.barcodes[0].barcode = final_code;\n\n//         // âœ… Only set defaults if empty (so user change is preserved)\n//         if (!frm.doc.barcodes[0].barcode_type) {\n//             frm.doc.barcodes[0].barcode_type = \"CODE-39\";\n//         }\n//         if (!frm.doc.barcodes[0].uom) {\n//             frm.doc.barcodes[0].uom = \"Nos\";\n//         }\n//     }\n//     frm.refresh_field(\"barcodes\");\n// }\n\n// // Populate child table from Item Group\n// function populate_parameters(frm, params) {\n//     frm.clear_table('custom_item_parameters');\n//     params.forEach(function(p) {\n//         let status = (p.status || '').toString().toLowerCase();\n//         if (status && status !== 'enabled' && status !== 'enable') {\n//             return;\n//         }\n//         let row = frm.add_child('custom_item_parameters');\n//         row.parameter = p.parameter || p.name || '';\n//         row.value = ''; // user will fill later\n//     });\n//     frm.refresh_field('custom_item_parameters');\n//     update_item_code_and_name(frm);\n// }\n\n// frappe.ui.form.on('Item', {\n//     item_group: function(frm) {\n//         if (!frm.doc.item_group) {\n//             frm.clear_table('custom_item_parameters');\n//             frm.refresh_field('custom_item_parameters');\n//             update_item_code_and_name(frm);\n//             return;\n//         }\n\n//         frappe.call({\n//             method: \"frappe.client.get\",\n//             args: { doctype: \"Item Group\", name: frm.doc.item_group },\n//             callback: function(r) {\n//                 if (r.message) {\n//                     const params = r.message.parameters || r.message.custom_parameters || [];\n//                     populate_parameters(frm, params);\n//                 }\n//             }\n//         });\n//     },\n//     validate: function(frm) {\n//         update_item_code_and_name(frm);\n\n//         // ðŸ”´ Validation: all parameter values must be filled\n//         if (frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0) {\n//             let missing = frm.doc.custom_item_parameters.filter(r => !r.value || r.value.trim() === \"\");\n//             if (missing.length > 0) {\n//                 // Collect missing parameter names\n//                 let missing_params = missing.map(r => r.parameter).join(\", \");\n//                 frappe.throw((\"Please fill {0} parameter values before saving.\", [missing_params]));\n//             }\n//         }\n//     },\n//     item_code: function(frm) {\n//         // When no parameters â†’ auto-fill item_name = item_code\n//         if (!(frm.doc.custom_item_parameters && frm.doc.custom_item_parameters.length > 0)) {\n//             if (frm.doc.item_code) {\n//                 frm.set_value('item_name', frm.doc.item_code);\n//             }\n//         }\n//     },\n//     item_name: function(frm) {\n//         update_item_code_and_name(frm);\n//     }\n// });\n\n// frappe.ui.form.on('Item Parameter', {\n//     value: function(frm) {\n//         update_item_code_and_name(frm);\n//     },\n//     custom_item_parameters_remove: function(frm) {\n//         update_item_code_and_name(frm);\n//     }\n// });",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 1,
  "modified": "2025-08-13 11:11:59.671096",
  "module": null,
  "name": "Hide_Add_Row_Tab",
  "script": "frappe.ui.form.on('Item', {\n    refresh(frm) {\n        let grid = frm.fields_dict['custom_item_parameters'].grid;\n\n        // Completely disable adding new rows (UI + keyboard)\n        grid.cannot_add_rows = true;\n        grid.only_sortable = true;\n\n        // Hide Add Row button\n        grid.wrapper.find('.grid-add-row').hide();\n        grid.wrapper.find('.grid-empty').remove();\n\n        // Hide delete checkboxes and icons\n        grid.wrapper.find('.grid-remove-rows').hide();\n        grid.wrapper.find('.grid-remove').hide();\n\n        // Override add_new_row method so nothing happens\n        grid.add_new_row = function() {\n            frappe.msgprint(__('You cannot add new rows in this table.'));\n            return false;\n        };\n    },\n\n    onload_post_render(frm) {\n        let grid = frm.fields_dict['custom_item_parameters'].grid;\n\n        grid.cannot_add_rows = true;\n        grid.only_sortable = true;\n\n        grid.wrapper.find('.grid-remove-rows').hide();\n        grid.wrapper.find('.grid-remove').hide();\n\n        // Override add_new_row again after render to be safe\n        grid.add_new_row = function() {\n            frappe.msgprint(__('You cannot add new rows in this table.'));\n            return false;\n        };\n    }\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "Item",
  "enabled": 0,
  "modified": "2025-08-21 14:29:54.498230",
  "module": null,
  "name": "ItemCode_to_Description",
  "script": "frappe.ui.form.on('Item', {\n    item_code(frm) {\n        if (frm.doc.item_code) {\n            frm.set_value('description', frm.doc.item_code);\n        } else {\n            frm.set_value('description', '');\n        }\n    }\n});\n",
  "view": "Form"
 },
 {
  "docstatus": 0,
  "doctype": "Client Script",
  "dt": "MiscellaneousMst",
  "enabled": 1,
  "modified": "2025-08-23 10:15:54.291883",
  "module": "galaxynext",
  "name": "Trantype-E_D",
  "script": "frappe.ui.form.on('MiscellaneousMst', {\n    refresh: function(frm) {\n        // Trantype filter (Enabled only)\n        frm.set_query(\"trantype\", function() {\n            return {\n                filters: {\n                    status: \"Enabled\"\n                }\n            };\n        });\n\n        // MiscellaneousMst Status filter (True only)\n        frm.set_query(\"status\", function() {\n            return {\n                filters: {\n                    status: 1   // jya tamaru field Boolean chhe, True = 1\n                }\n            };\n        });\n    }\n});\n",
  "view": "Form"
 }
]